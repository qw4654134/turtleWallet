import{a3 as e,y as t,o as i,c as s,w as a,b as l,S as o,T as n,v as r,d as c,t as p,V as h,e as d,u as m,i as u,a as f,s as _,H as g,I as y,r as b,p as w,q as v,F as k,af as C,A as x,a2 as S,R as A}from"./index.e3856387.js";import{_ as O}from"./uni-icons.c040caaf.js";import{r as z}from"./uni-app.es.039f777e.js";import{_ as $}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as j}from"./pin-popup.3870e030.js";import{A as P}from"./app.39bb0535.js";import"./md5.c7cedf05.js";import{E as V}from"./etherApi.29d22b7c.js";import{W as I}from"./wallet.d7a37044.js";import{_ as B}from"./right.af8a0f8e.js";import"./pin-code-keyboard.d34bb241.js";import"./uni-popup.b6a30396.js";import"./pin.5f0ee5b9.js";import"./close.458bce50.js";import"./config.d9a5f6eb.js";import"./wallet.f064e6a3.js";const E=$({name:"uniCollapseItem",props:{title:{type:String,default:""},name:{type:[Number,String],default:""},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!0},open:{type:Boolean,default:!1},thumb:{type:String,default:""},titleBorder:{type:String,default:"auto"},border:{type:Boolean,default:!0},showArrow:{type:Boolean,default:!0}},data:()=>({isOpen:!1,isheight:null,height:0,elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,nameSync:0}),watch:{open(e){this.isOpen=e,this.onClick(e,"init")}},updated(e){this.$nextTick((()=>{this.init(!0)}))},created(){this.collapse=this.getCollapse(),this.oldHeight=0,this.onClick(this.open,"init")},unmounted(){this.__isUnmounted=!0,this.uninstall()},mounted(){this.collapse&&(""!==this.name?this.nameSync=this.name:this.nameSync=this.collapse.childrens.length+"",-1===this.collapse.names.indexOf(this.nameSync)?this.collapse.names.push(this.nameSync):console.warn(`name 值 ${this.nameSync} 重复`),-1===this.collapse.childrens.indexOf(this)&&this.collapse.childrens.push(this),this.init())},methods:{init(e){this.getCollapseHeight(e)},uninstall(){this.collapse&&(this.collapse.childrens.forEach(((e,t)=>{e===this&&this.collapse.childrens.splice(t,1)})),this.collapse.names.forEach(((e,t)=>{e===this.nameSync&&this.collapse.names.splice(t,1)})))},onClick(e,t){this.disabled||(this.isOpen=e,this.isOpen&&this.collapse&&this.collapse.setAccordion(this),"init"!==t&&this.collapse.onChange(e,this))},getCollapseHeight(t,i=0){e().in(this).select(`#${this.elId}`).fields({size:!0},(e=>{if(!(i>=10)){if(!e)return i++,void this.getCollapseHeight(!1,i);this.height=e.height,this.isheight=!0,t||this.onClick(this.isOpen,"init")}})).exec()},getNvueHwight(e){dom.getComponentRect(this.$refs["collapse--hook"],(t=>{if(t&&t.result&&t.size){if(this.height=t.size.height,this.isheight=!0,e)return;this.onClick(this.open,"init")}}))},getCollapse(e="uniCollapse"){let t=this.$parent,i=t.$options.name;for(;i!==e;){if(t=t.$parent,!t)return!1;i=t.$options.name}return t}}},[["render",function(e,f,_,g,y,b){const w=d,v=m,k=u,C=z(t("uni-icons"),O);return i(),s(k,{class:"uni-collapse-item"},{default:a((()=>[l(k,{onClick:f[0]||(f[0]=e=>b.onClick(!y.isOpen)),class:o(["uni-collapse-item__title",{"is-open":y.isOpen&&"auto"===_.titleBorder,"uni-collapse-item-border":"none"!==_.titleBorder}])},{default:a((()=>[l(k,{class:"uni-collapse-item__title-wrap"},{default:a((()=>[n(e.$slots,"title",{},(()=>[l(k,{class:o(["uni-collapse-item__title-box",{"is-disabled":_.disabled}])},{default:a((()=>[_.thumb?(i(),s(w,{key:0,src:_.thumb,class:"uni-collapse-item__title-img"},null,8,["src"])):r("",!0),l(v,{class:"uni-collapse-item__title-text"},{default:a((()=>[c(p(_.title),1)])),_:1})])),_:1},8,["class"])]),!0)])),_:3}),_.showArrow?(i(),s(k,{key:0,class:o([{"uni-collapse-item__title-arrow-active":y.isOpen,"uni-collapse-item--animation":!0===_.showAnimation},"uni-collapse-item__title-arrow"])},{default:a((()=>[l(C,{color:_.disabled?"#ddd":"#bbb",size:"14",type:"bottom"},null,8,["color"])])),_:1},8,["class"])):r("",!0)])),_:3},8,["class"]),l(k,{class:o(["uni-collapse-item__wrap",{"is--transition":_.showAnimation}]),style:h({height:y.isOpen?"auto":"0rpx"})},{default:a((()=>[l(k,{id:y.elId,ref:"collapse--hook",class:o(["uni-collapse-item__wrap-content",{open:y.isheight,"uni-collapse-item--border":_.border&&y.isOpen}])},{default:a((()=>[n(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","class"])])),_:3},8,["class","style"])])),_:3})}],["__scopeId","data-v-39698b21"]]);const H=$({name:"uniCollapse",emits:["change","activeItem","input","update:modelValue"],props:{value:{type:[String,Array],default:""},modelValue:{type:[String,Array],default:""},accordion:{type:[Boolean,String],default:!1}},data:()=>({}),computed:{dataValue(){let e="string"==typeof this.value&&""===this.value||Array.isArray(this.value)&&0===this.value.length;"string"==typeof this.modelValue&&""===this.modelValue||Array.isArray(this.modelValue)&&this.modelValue.length;return e?this.modelValue:this.value}},watch:{dataValue(e){this.setOpen(e)}},created(){this.childrens=[],this.names=[]},mounted(){this.$nextTick((()=>{this.setOpen(this.dataValue)}))},methods:{setOpen(e){let t="string"==typeof e,i=Array.isArray(e);this.childrens.forEach(((s,a)=>{if(t&&e===s.nameSync){if(!this.accordion)return void console.warn("accordion 属性为 false ,v-model 类型应该为 array");s.isOpen=!0}i&&e.forEach((e=>{if(e===s.nameSync){if(this.accordion)return void console.warn("accordion 属性为 true ,v-model 类型应该为 string");s.isOpen=!0}}))})),this.emit(e)},setAccordion(e){this.accordion&&this.childrens.forEach(((t,i)=>{e!==t&&(t.isOpen=!1)}))},resize(){this.childrens.forEach(((e,t)=>{e.getCollapseHeight()}))},onChange(e,t){let i=[];this.accordion?i=e?t.nameSync:"":this.childrens.forEach(((e,t)=>{e.isOpen&&i.push(e.nameSync)})),this.$emit("change",i),this.emit(i)},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e)}}},[["render",function(e,t,l,o,r,c){const p=u;return i(),s(p,{class:"uni-collapse"},{default:a((()=>[n(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-3aec18a2"]]);const N=$({data:()=>({network_list:f().globalData.global_network_list,global_network_index:f().globalData.global_network_index,path_list:[{title:"Default",path:"m/44'/60'/0'/0/0"},{title:"Ledger",path:"m/44'/60'/0'/0"},{title:"Customize",path:"m/44'/60'/1'/0/0"}],selected_path_index:0,mnemonic:"",customize_path:""}),onLoad(){P.checkAppInit()},onShow(){},methods:{choosePath(e){this.selected_path_index=e},showPinPopup(e){return this.mnemonic=e.detail.value.mnemonic,this.customize_path=e.detail.value.customize_path,this.mnemonic?"Customize"!=this.path_list[this.selected_path_index].title||this.customize_path?void this.$refs.pin_popup.show():(_({title:"Please set path",icon:"error"}),!1):(_({title:"Please enter mnemonic",icon:"error"}),!1)},verifyPinCode(e){let t=e.ret;t?(this.$refs.pin_popup.closePopup(),this.importWallet(this.mnemonic,this.customize_path,t)):_({title:"PIN error",icon:"none"})},async importWallet(e,t,i){g({title:"importing..."});let s=this.path_list[this.selected_path_index].path;"Customize"==this.path_list[this.selected_path_index].title&&(s=t);let a=new V.etherApi(this.network_list[this.global_network_index],!1).fromMnemonic(e.trim(),s);if(console.log(JSON.stringify(a)),!a.ret)return y(),_({title:a.msg?a.msg:"Failed to import wallet,please try again",icon:"error"}),!1;let l=await I.encryptWallet(a.data.privateKey,i);if(!l)return y(),_({title:"Failed to import wallet,please try again",icon:"error"}),!1;let o={};return o.address=a.data.address,o.keystore=JSON.parse(l),I.saveWallet(o)?(I.setDefaultWallet(o.address),y(),_({title:"Import succeeded"}),setTimeout((()=>{b({url:"/pages/index/wallet"})}),1200),!0):(y(),_({title:"Failed to import wallet,please try again",icon:"error"}),!1)}}},[["render",function(e,n,h,m,f,_){const g=u,y=C,b=d,O=A,$=z(t("uni-collapse-item"),E),P=z(t("uni-collapse"),H),V=x,I=S,N=z(t("pin-popup"),j);return i(),s(g,{class:"container"},{default:a((()=>[l(I,{onSubmit:_.showPinPopup},{default:a((()=>[l(g,{class:"mne-form-item"},{default:a((()=>[l(g,{class:"font-desc-black"},{default:a((()=>[c("Mnemonic")])),_:1}),l(y,{class:"mnemonic-text",name:"mnemonic",maxlength:"400",cols:"30",rows:"10",placeholder:"Enter mnemonic phrases separated by space"})])),_:1}),l(g,{class:"mne-form-item advanced-item"},{default:a((()=>[l(P,null,{default:a((()=>[l($,{title:"Advanced (Set path)","show-animation":!0,"title-border":"none",border:!1},{default:a((()=>[l(g,{class:"path-list"},{default:a((()=>[(i(!0),w(k,null,v(f.path_list,((e,t)=>(i(),s(g,{class:o(["path-item",[t!=f.path_list.length-1?"path-item-border":""]]),onClick:e=>_.choosePath(t)},{default:a((()=>[l(g,{class:"flex-row-space-between-center"},{default:a((()=>[l(g,null,{default:a((()=>[l(g,{class:"font-desc-black"},{default:a((()=>[c(p(e.title),1)])),_:2},1024),l(g,{class:"font-desc-gray-little"},{default:a((()=>[c(p(e.path),1)])),_:2},1024)])),_:2},1024),t==f.selected_path_index?(i(),s(b,{key:0,class:"is-path-select",mode:"widthFix",src:B})):r("",!0)])),_:2},1024),"Customize"==f.path_list[f.selected_path_index].title&&"Customize"==f.path_list[t].title?(i(),s(g,{key:0,class:"customize-path-item"},{default:a((()=>[l(O,{class:"customize-path",type:"text",name:"customize_path",value:e.path},null,8,["value"])])),_:2},1024)):r("",!0)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})])),_:1}),l(g,{class:"confirm-btn"},{default:a((()=>[l(V,{"form-type":"submit",class:"form-btn",type:"primary"},{default:a((()=>[c("confirm")])),_:1})])),_:1})])),_:1},8,["onSubmit"]),l(N,{ref:"pin_popup",pop_title:"Please enter PIN",onVerifyRet:_.verifyPinCode},null,8,["onVerifyRet"])])),_:1})}],["__scopeId","data-v-918511a7"]]);export{N as default};
