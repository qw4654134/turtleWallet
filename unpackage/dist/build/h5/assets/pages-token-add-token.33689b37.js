import{a as t,s as e,H as o,I as a,j as s,r as n,o as r,c as i,w as c,i as l,b as f,d,t as _,v as m,R as u,A as k,a2 as h}from"./index.e3856387.js";import{A as b}from"./app.39bb0535.js";import{E as p}from"./etherApi.29d22b7c.js";import{g as w}from"./graceChecker.21ec0954.js";import{T as g}from"./token.bb23f639.js";import{_ as y}from"./_plugin-vue_export-helper.cdc0426e.js";import"./config.d9a5f6eb.js";import"./wallet.f064e6a3.js";const x=y({data:()=>({network_list:t().globalData.global_network_list,global_network_index:t().globalData.global_network_index,current_network:{network:"__",url:"",color:"#f6f6f6",etherscan_api:""},btn_text:"Next",show_token_info:!1,token_info:{symbol:"",decimal:0,total_supply:0,abi:null}}),onLoad(t){b.checkAppInit()&&(this.current_network=this.network_list[this.global_network_index])},methods:{formSubmit(t){"Next"==this.btn_text?this.getContractInfo(t.detail.value.contract_address):"Add Token"==this.btn_text&&this.addToken()},async getContractInfo(t){let n={};n.contract_address=String(t).trim();if(!w.check(n,[{name:"contract_address",checkType:"notnull",checkRule:"",errorMsg:"Please enter contract address"},{name:"contract_address",checkType:"reg",checkRule:"^0x[0-9a-fA-F]{40}$",errorMsg:"Incorrect contract address"}]))return e({title:w.error,icon:"none"}),!1;this.show_token_info=!1,o({});let r=new p.etherApi(this.current_network),i=await r.getContractABI(n.contract_address);if(!i)return a(),e({title:"Failed to retrieve contract info",icon:"error",duration:2e3}),!1;if(!g.verifyContractStandardFunc(i))return a(),s({title:"This contract cannot be used due to lack of necessary functions",showCancel:!1,confirmText:"Got it"}),!1;let c=await r.getContractAssetBaseInfo(n.contract_address,i);return c?(a(),this.btn_text="Add Token",this.token_info=c,this.token_info.abi=i,this.show_token_info=!0,console.log(this.token_info),this.token_info):(a(),e({title:"Failed to retrieve contract info",icon:"error",duration:2e3}),!1)},addToken(){return g.saveTokenInfo(this.token_info)?(e({title:"Successful",icon:"success",duration:2e3}),n({url:"/pages/index/wallet"}),!0):(e({title:"Failed to add token",icon:"error",duration:2e3}),!1)}}},[["render",function(t,e,o,a,s,n){const b=l,p=u,w=k,g=h;return r(),i(b,{class:"container"},{default:c((()=>[f(g,{onSubmit:n.formSubmit},{default:c((()=>[f(b,{class:"form-item"},{default:c((()=>[f(b,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Contract Address")])),_:1}),f(b,{class:"form-item-content"},{default:c((()=>[f(p,{class:"form-item-input",type:"text",name:"contract_address"})])),_:1})])),_:1}),s.show_token_info?(r(),i(b,{key:0,class:"form-item"},{default:c((()=>[f(b,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Symbol")])),_:1}),f(b,{class:"form-item-info"},{default:c((()=>[f(b,{class:""},{default:c((()=>[d(_(s.token_info.symbol),1)])),_:1})])),_:1})])),_:1})):m("",!0),s.show_token_info?(r(),i(b,{key:1,class:"form-item"},{default:c((()=>[f(b,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Total Supply")])),_:1}),f(b,{class:"form-item-info"},{default:c((()=>[f(b,{class:""},{default:c((()=>[d(_(s.token_info.total_supply),1)])),_:1})])),_:1})])),_:1})):m("",!0),s.show_token_info?(r(),i(b,{key:2,class:"form-item"},{default:c((()=>[f(b,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Decimal")])),_:1}),f(b,{class:"form-item-info"},{default:c((()=>[f(b,{class:""},{default:c((()=>[d(_(s.token_info.decimal),1)])),_:1})])),_:1})])),_:1})):m("",!0),f(w,{"form-type":"submit",class:"form-btn",type:"primary"},{default:c((()=>[d(_(s.btn_text),1)])),_:1})])),_:1},8,["onSubmit"])])),_:1})}],["__scopeId","data-v-4b5a8629"]]);export{x as default};
