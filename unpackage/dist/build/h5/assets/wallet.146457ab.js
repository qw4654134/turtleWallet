import{g as t,f as e,s as r}from"./index.00515032.js";import"./md5.c7cedf05.js";import{W as a}from"./wallet.f064e6a3.js";const l={wallet_list_key:"storage_wallet_list",createWallet:function(){return a.createRandom()},encryptWallet:async function(t,e){if(!t||!e)return!1;try{const r=new a(t);return await r.encrypt(e)}catch(r){return console.log(r),!1}},decryptWallet:async function(t,e){if(!t||!e)return!1;try{return await a.fromEncryptedJson(t,e)}catch(r){return console.log(r),!1}},getWalletList:function(){try{var e=t(this.wallet_list_key),r=JSON.parse(e);return Array.isArray(r)?r:[]}catch(a){return!1}},saveWallet:function(t){var a=this.getWalletList();if(a||(a=[]),!t)return!1;for(var l=0;l<a.length;l++)if(String(a[l].address).toLowerCase()==String(t.address).toLowerCase()){a.splice(l,1);break}t.name||(t.name="ETH Wallet "+t.address.substr(2,4)),a.push(t);try{return e(this.wallet_list_key,JSON.stringify(a)),console.log("已存储wallet:"+t.address),!0}catch(s){return console.log(s),r({title:"failed to save wallet"}),!1}},getWallet:function(t){var e=this.getWalletList();if(!e)return!1;for(let r of e)if(String(t).toLowerCase()==String(r.address).toLowerCase())return r;return!1},delWallet:function(t){var r=this.getWalletList();if(!r)return!1;for(var a=0;a<r.length;a++)if(String(r[a].address).toLowerCase()==String(t).toLowerCase()){r.splice(a,1),e(this.wallet_list_key,JSON.stringify(r));break}return!0},setDefaultWallet:function(t){var r=this.getWalletList(),a=!1;if(!r)return!1;for(let e of r)e.is_default_wallet=!1,String(t).toLowerCase()==String(e.address).toLowerCase()&&(e.is_default_wallet=!0,a=e);return!!a&&(e(this.wallet_list_key,JSON.stringify(r)),a)},getDefaultWallet:function(){var t=this.getWalletList(),e=!1;if(!t)return!1;for(let r of t)r.is_default_wallet&&(e=r);return e||(this.setDefaultWallet(t[0].address),t[0])},getPrivateKey:async function(t,e){let r=this.getWallet(t);return!!r&&await this.decryptWallet(JSON.stringify(r.keystore),e)}};export{l as W};
