import{j as e,X as t,$ as i,s as a,Y as s,Z as n,M as o,r as c,H as l,I as r,a as p,_ as d,o as _,c as m,w as h,i as f,b as u,d as w,t as b,v as g,y as k,a0 as y}from"./index.e3856387.js";import{_ as x}from"./pin-code-keyboard.d34bb241.js";import{r as v}from"./uni-app.es.039f777e.js";import{_ as j}from"./uni-icons.c040caaf.js";import{A as P}from"./app.39bb0535.js";import"./md5.c7cedf05.js";import{P as C}from"./pin.5f0ee5b9.js";import{C as I}from"./config.d9a5f6eb.js";import{W as T}from"./wallet.d7a37044.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";import"./wallet.f064e6a3.js";const N=S({data:()=>({scene:"",method:"",input_time:"",create_pin_title:"Create a PIN",create_pin_desc:"This PIN will unlock your wallet only on this device",init_pin_code:"",pin_code:"",show_recreate:!1,sample_wallets:[{address:"0x03b5b0221fd758c16ced3c3402f830234cf73bb8",private_key:"0x660838b83ce4a086dda8c18724e18265dacd7e5591bb0f86631f7b8e7dccda55"},{address:"0x6A01aaa2edA6f55DB4b4906e807837CBA2dfBc80",private_key:"0x0448beb6c9bcb366932944f711cdd148172c6c54dc5fccc96f92bb740862ea48"}],tip:""}),onLoad(i){if(P.checkAppInit()){if(!i.scene||!i.input_time||String("|create-wallet|import-wallet|guest-mode|").indexOf(i.scene)<0||String("|1|2|").indexOf(String(i.input_time))<0||"import-wallet"==i.scene&&String("|mnemonic|private-key|keystore|").indexOf(i.method)<0)return e({title:"Data exception, please contact admin",showCancel:!1,confirmText:"Got it",success(){t()}}),console.log("进入create-pin页面的参数异常"),!1;i&&i.tip&&(this.tip=i.tip),this.scene=i.scene,this.method=i.method,this.input_time=i.input_time,1==this.input_time?(this.create_pin_title="Create a PIN",this.create_pin_desc="This PIN will unlock your wallet only on this device"):(this.create_pin_title="Type your PIN again",this.create_pin_desc="Make sure remember it all time")}},onUnload(){i("pin_code_set1")},onShow(){if(1==this.input_time)try{this.$refs.pin_code_keyboard.clear()}catch(e){console.log(e)}},methods:{pinChange:function(e){},pinFinish:function(e){if(e.pin_code)switch(this.pin_code=e.pin_code,this.input_time){case"1":C.setPIN(this.pin_code);let e="/pages/setup-wallet/create-pin?scene="+this.scene+"&input_time=2";"import-wallet"==this.scene&&(e="/pages/setup-wallet/create-pin?scene="+this.scene+"&method="+this.method+"&input_time=2"),o({url:e});break;case"2":if(!C.compare(this.pin_code))return a({title:"The two inputs are inconsistent",icon:"error",duration:2e3}),void(this.show_recreate=!0);if("create-wallet"==this.scene)s("pin_code_set1",(()=>{n("pin_code_set",{pin:this.pin_code})})),o({url:"/pages/setup-wallet/wallet-phrase"});else if("import-wallet"==this.scene){let e="";"mnemonic"==this.method&&(e="/pages/setup-wallet/import-mnemonic"),"private-key"==this.method&&(e="/pages/setup-wallet/import-private"),"keystore"==this.method&&(e="/pages/setup-wallet/import-keystore"),e||console.log("参数错误"),c({url:e})}else"guest-mode"==this.scene&&this.loadSampleWallet(this.pin_code)}},reEnterPinError:function(e){this.$refs.pin_code_keyboard.clear(),console.log("clear")},loadSampleWallet:async function(e){l({title:"Loading sample wallet"});for(let t of this.sample_wallets){let i=await T.encryptWallet(t.private_key,e);if(!i){a({title:"Failed to load sample wallet",icon:"error"});continue}let s={};s.address=t.address,s.keystore=JSON.parse(i),T.saveWallet(s)||a({title:"Failed to load sample wallet",icon:"error"})}r(),p().globalData.global_network_index=1,d({key:"storage_default_network",data:I.block_chain_net.eth.net_list[p().globalData.global_network_index].network,success:function(){console.log("已切换至 test network")}}),a({title:"The sample wallet has been loaded",icon:"none"}),setTimeout((()=>{c({url:"/pages/index/wallet",success(){},fail(){c({url:"/pages/start/start-up"})}})}),1e3)}}},[["render",function(e,t,i,a,s,n){const o=f,c=v(k("pin-code-keyboard"),x),l=v(k("uni-icons"),j),r=y;return _(),m(o,{class:"container"},{default:h((()=>[u(o,{class:"create-pin-text"},{default:h((()=>[u(o,{class:"create-pin-title font-first-title"},{default:h((()=>[w(b(s.create_pin_title),1)])),_:1}),u(o,{class:"create-pin-desc font-desc-black"},{default:h((()=>[w(b(s.create_pin_desc),1)])),_:1})])),_:1}),u(c,{ref:"pin_code_keyboard",init_pin_code:s.init_pin_code,onChange:n.pinChange,onFinish:n.pinFinish,codePaddingTop:"150rpx",keyboardPaddingTop:"100rpx"},null,8,["init_pin_code","onChange","onFinish"]),s.show_recreate?(_(),m(r,{key:0,class:"reset-pin flex-row-center-center","open-type":"navigateBack"},{default:h((()=>[u(o,{class:"font-desc-black"},{default:h((()=>[w("Recreate")])),_:1}),u(l,{type:"forward"})])),_:1})):g("",!0),""!=s.tip?(_(),m(o,{key:1,class:"tip flex-row-center-center font-desc-gray"},{default:h((()=>[u(o,{style:{width:"80%"}},{default:h((()=>[w(b(s.tip),1)])),_:1})])),_:1})):g("",!0)])),_:1})}],["__scopeId","data-v-bab6ca3e"]]);export{N as default};
