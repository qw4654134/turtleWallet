import{a as t,I as e,s as o,H as a,j as n,r as s,o as r,c as i,w as c,i as l,b as f,d,t as _,v as m,R as u,A as k,a2 as h}from"./index.0a4c0685.js";import{A as p}from"./app.0d53c675.js";import{E as b}from"./etherApi.1ad454b5.js";import{g as w}from"./graceChecker.21ec0954.js";import{T as g}from"./token.9d364b80.js";import{_ as y}from"./_plugin-vue_export-helper.cdc0426e.js";import"./config.56fe6dcf.js";import"./wallet.f064e6a3.js";const x=y({data:()=>({network_list:t().globalData.global_network_list,global_network_index:t().globalData.global_network_index,current_network:{network:"__",url:"",color:"#f6f6f6",etherscan_api:""},btn_text:"Next",show_token_info:!1,token_info:{symbol:"",decimal:0,total_supply:0,abi:null}}),onLoad(t){p.checkAppInit()&&(this.current_network=this.network_list[this.global_network_index])},methods:{formSubmit(t){"Next"==this.btn_text?this.getContractInfo(t.detail.value.contract_address).then((function(t){}),(function(t){console.log(t),e()})):"Add Token"==this.btn_text&&this.addToken()},async getContractInfo(t){let s={};s.contract_address=String(t).trim();if(!w.check(s,[{name:"contract_address",checkType:"notnull",checkRule:"",errorMsg:"Please enter contract address"},{name:"contract_address",checkType:"reg",checkRule:"^0x[0-9a-fA-F]{40}$",errorMsg:"Incorrect contract address"}]))return o({title:w.error,icon:"none"}),!1;this.show_token_info=!1,a({});let r=new b.etherApi(this.current_network),i=await r.getContractABI(s.contract_address);if(!i)return e(),o({title:"Failed to retrieve contract info",icon:"error",duration:2e3}),!1;if(!g.verifyContractStandardFunc(i))return e(),n({title:"This contract cannot be used due to lack of necessary functions",showCancel:!1,confirmText:"Got it"}),!1;let c=await r.getContractAssetBaseInfo(s.contract_address,i);return c?(e(),this.btn_text="Add Token",this.token_info=c,this.token_info.abi=i,this.show_token_info=!0,console.log(this.token_info),this.token_info):(e(),o({title:"Failed to retrieve contract info",icon:"error",duration:2e3}),!1)},addToken(){return g.saveTokenInfo(this.token_info)?(o({title:"Successful",icon:"success",duration:2e3}),s({url:"/pages/index/wallet"}),!0):(o({title:"Failed to add token",icon:"error",duration:2e3}),!1)}}},[["render",function(t,e,o,a,n,s){const p=l,b=u,w=k,g=h;return r(),i(p,{class:"container"},{default:c((()=>[f(g,{onSubmit:s.formSubmit},{default:c((()=>[f(p,{class:"form-item"},{default:c((()=>[f(p,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Contract Address")])),_:1}),f(p,{class:"form-item-content"},{default:c((()=>[f(b,{class:"form-item-input",type:"text",name:"contract_address"})])),_:1})])),_:1}),n.show_token_info?(r(),i(p,{key:0,class:"form-item"},{default:c((()=>[f(p,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Symbol")])),_:1}),f(p,{class:"form-item-info"},{default:c((()=>[f(p,{class:""},{default:c((()=>[d(_(n.token_info.symbol),1)])),_:1})])),_:1})])),_:1})):m("",!0),n.show_token_info?(r(),i(p,{key:1,class:"form-item"},{default:c((()=>[f(p,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Total Supply")])),_:1}),f(p,{class:"form-item-info"},{default:c((()=>[f(p,{class:""},{default:c((()=>[d(_(n.token_info.total_supply),1)])),_:1})])),_:1})])),_:1})):m("",!0),n.show_token_info?(r(),i(p,{key:2,class:"form-item"},{default:c((()=>[f(p,{class:"form-item-title font-desc-black"},{default:c((()=>[d("Decimal")])),_:1}),f(p,{class:"form-item-info"},{default:c((()=>[f(p,{class:""},{default:c((()=>[d(_(n.token_info.decimal),1)])),_:1})])),_:1})])),_:1})):m("",!0),f(w,{"form-type":"submit",class:"form-btn",type:"primary"},{default:c((()=>[d(_(n.btn_text),1)])),_:1})])),_:1},8,["onSubmit"])])),_:1})}],["__scopeId","data-v-32baabda"]]);export{x as default};
